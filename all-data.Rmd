---
title: "Current Data"
output:
  html_document:
    toc: no
    highlight: tango
editor_options:
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(dpi = 300)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)


source(here::here('R', '00_vis_custom.R'))
source(here::here('R', '00_load-packages.R'))
```

```{r load-data, include = FALSE, results = FALSE}

source(here::here('R', '02_load_data.R'))
source(here::here('R', '03_wrangle_data.R'))
source(here::here('R', '06_tables.R'))
```

Contains all data from both ISCO and tank collection methods from all reserves that submitted data.

# TAL Sensor CHLA (RFU) vs. Extracted CHLA ($\mu$g/L) {.tabset .tabset-pills}

## All 

```{r}
source(here::here('R', '04.1_all-figures.R'))

all_figure
```

## Reserve and Methods

Current Data with reserves and the methods pulled out.

```{r}
all_reserve_method_figure
```

## Reserve and Methods (Interactive)

**How to use the interactive plot:** Hover over interactive plot for the tools panel to appear in top-right corner. Tools include: save plot, zoom, select (lasso or box), and data compare. Hover your cursor over a point for more information. You can also double click on an item in the legend to isolate that data series in the plot!

```{r, dpi = 120}
m = list(
    l = 80,
    r = 150,
    b = 80,
    t = 50,
    pad = 0
  )

all_interactive <- ggplotly(
                      all %>% 
                        dplyr::filter(qaqc == 0) %>% 
                        ggplot(aes(x = chlorophyll_rfu, y = chla_ugl)) +
                        geom_point(aes(color = reserve_code, shape = method), position = "jitter") +
                        stat_smooth(method = "lm", color = "black", se = FALSE) +
                        scale_colour_manual(name = "Reserve", values = reservecolours) +
                        scale_shape_discrete(name = "Method") +
                        scale_y_continuous(expand = c(0,0)) +
                        theme_classic() +
                        labs(x = "Chlorophyll a (RFU) EXO",
                             y = "Chlorophyll a (ug/L) Extracted",
                             caption = "ISCO and tank experiments"),
                      tooltip = c("method", "chlorophyll_rfu", "chla_ugl", "reserve_code")
                      )
all_interactive %>% layout(margin = m)

rm(all_interactive, m)
```

## Tank vs ISCO

```{r}
tank_isco
```

{-}

***

# Summary Information

```{r tables-load, results = FALSE, include = FALSE}
source(here::here('R', '06_tables.R'))
```


```{r summary-table, caption = ""}

sum_table_final  %>% 
  kbl(align = "c", caption = 'Summary information for all parameters (Min-Max (Mean \U00B1 Standard Dev)) from each participating reserve for both tank and ISCO experiments.') %>% 
  kable_styling(fixed_thead = T) %>% 
  row_spec(0, bold = T) %>% 
  column_spec(1, border_right = T) %>% 
  column_spec(3, border_right = T) %>% 
  kable_classic(c('striped', 'hover'), html_font = "Open Sans", full_width = F)
```

***

# Interference Parameters {.tabset .tabset-pills}

These are the three parameters of interest in the interference testing studies. The following is the chlorophyll a fluorescence (RFU) from the EXO total algae sensor by the extracted $\mu$g/L with the three parameters of interest overlayed as color.

**How to use the interactive plot:** Hover over interactive plot for the tools panel to appear in top-right corner. Tools include: save plot, zoom, select (lasso or box), and data compare. Hover your cursor over a point for more information.

## fDOM 

```{r fdom-interf-interact, dpi = 120}

interference_interactive_all_fxn(param = fdom)

```


## Turbidity

Had to filter to remove turbidity values > 240 NTU due to an outlier.

```{r turb-interf-interact, dpi = 120}

interference_interactive_all_fxn(param = turbidity)
```



## Temperature 

```{r temp-interf-interact, dpi = 120}

interference_interactive_all_fxn(param = temperature)
```

